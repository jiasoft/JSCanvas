<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>canvas</title>
<meta name="Keywords" content="canvas demo" />
<meta name="Description" content="canvas demo" />
<meta name="robots" content="index, follow" />
<meta name="googlebot" content="index, follow" />
<meta name="viewport" content="width=device-width,minimum-scale=0.5,initial-scale=0.2,maximum-scale=0.5,user-scalable=no" />
<style>
body{padding:0px;margin:0px;padding-top:200px;}
button{vertical-align:top;}
</style>
</head>
<body>
	<div style="width:1000px;margin:auto;">
	<canvas width="1000" height="572" id="democavs" _style="position:fixed;top:20px;left:20px;"></canvas>
	</div>
	<div id="msg"></div>
	<script type="text/javascript" src="../jfcanvas.js"></script>
	<script>
		
		var msg = document.getElementById("msg");
		
		
		var TextureAtlasBG = {
			imagePath:"rs/a.jpg",
			SubTexture:[
				{name:'bg1',x:0,y:100,width:1040,height:700,frameX:0,frameY:0,frameWidth:1040,frameHeight:700}
			]
		};
		var TexureAtlasKenfs = {
			imagePath:"rs/ken_src.png",
			SubTexture:[
			{ name:"ken_00",x:12,y:79,width:46,	 height:82,frameX:-23,frameY:-41},
			{ name:"ken_01",x:84,y:79,	width:46,height:82,frameX:-23,frameY:-41},
			{ name:"ken_02",x:154,y:79,	width:46,height:82,frameX:-23,frameY:-41},
			{ name:"ken_04",x:223,y:79,	width:46,height:82,frameX:-23,frameY:-41}
			]
		};
		var TextureAtlasBGKenKill = {
			imagePath:"rs/ken_src.png",
			SubTexture:[
			{ name:"ken_jum_00",x:6,y:0,width:55,	 height:78,frameX:-27,frameY:-39},
			{ name:"ken_jum_01",x:78,y:0,	width:55,height:78,frameX:-27,frameY:-39},
			{ name:"ken_jum_02",x:143,y:0,	width:66,height:78,frameX:-27,frameY:-39},
			{ name:"ken_jum_04",x:215,y:0,	width:73,height:78,frameX:-27,frameY:-39}
			]
		};
		
		var textureAtlwave = {
			imagePath:"rs/ken_src.png",
			SubTexture:[
			{ name:"wave_00",x:6,y:337,	width:35,height:29,frameX:-18,frameY:-14},
			{ name:"wave_01",x:77,y:337,width:35,height:29,frameX:-18,frameY:-14}
			]
		};

		setTimeout(function(){
			JF.stage.init("democavs");
			
			/*背景*/
			var bg = new JF.DObject();
			bg.x = 0;bg.y = 0;bg.width=800;height=700;
			bg.setTexture(TextureAtlasBG);
			JF.stage.add(bg);
			
			/*防御*/
			var kenfs = new JF.DObject();
			kenfs.setTexture(TexureAtlasKenfs);
			kenfs.x = 200;
			kenfs.y = 500;
			kenfs.width = 46;
			kenfs.height =82;
			kenfs.frameTime = 10;
			kenfs.run(function(){
				if(JF.stage.controller.up)
					kenfs.y-=5;
				if(JF.stage.controller.down)
					kenfs.y+=5;
				if(JF.stage.controller.left)
					kenfs.x-=5;
				if(JF.stage.controller.right)
					kenfs.x+=5;
				
			});
			JF.stage.add(kenfs);
			
			/*进功*/
			var kenkill = new JF.DObject();
			kenkill.setTexture(TextureAtlasBGKenKill);
			
			kenkill.x = 200;
			kenkill.y =500;
			kenkill.width = 78;
			kenkill.height = 55;
			kenkill.frameTime = 3;
			kenkill.loop = 1;
			
			
			var ware = new JF.DObject();
			ware.width = 35;
			ware.height = 29;
			ware.setTexture(textureAtlwave);
			ware.frameTime = 12;
			
			JF.stage.addEvent(function(obj){

				if(obj.type=="action.jump")
					kenfs.animate('y',200,2000,function(){
						kenfs.animate('y',500,2000);
					});
			});
			
				
			var ken1 = new JF.DObject();
			ken1.setTexture(TexureAtlasKenfs);
			ken1.x = 800;
			ken1.y = 500;
			ken1.frameTime =10;
			ken1.width = 78;
			ken1.height = 55;
			ken1.scaleX = -1;
			ken1.loop = -1;
			//ken1.canCollision = true;
			JF.stage.add(ken1);
			
			var ken_runend = function(obj){
	
				if(obj.type == 'run.end'){
					var s =obj.curObj;
					ware.x = s.x+60;
					ware.y = s.y;
					ware.alpha = 1;
					//ware.canCollision = true;
					JF.stage.add(ware);
					ware.animate('x',780,3000,function(){
						ware.animate('alpha',0.1,300,function(){
							JF.stage.remove(ware);
							JF.stage.remove(kenkill);
							JF.stage.add(kenfs);
						});
					});
				}
			}
			kenkill.addEvent(ken_runend);
			
			JF.stage.addEvent(function(obj){
				if(obj.type=="action.kill"){
					JF.stage.remove(kenfs);
					kenkill.x = kenfs.x;
					kenkill.y = kenfs.y;
					kenkill.loop =1;
					JF.stage.add(kenkill);
				}else if(obj.type=="mouse.up"){
						rad.animates({'y':obj.pos.y,x:obj.pos.x},3000);
				}
				else if(obj.type=="touch.end"){
					
				}
				else if(obj.type == 'mouse.move'){
					mouseLine.x = obj.pos.x;
					mouseLine.y = obj.pos.y
				}
			});
			
			var bdr = new JF.DObject('dbr');
			bdr.x = 600;
			bdr.y = 300;
			bdr.width = 350;
			bdr.height=350;
			bdr.canCollision = true;
			bdr.setBGBorder(1,'red');
			bdr.addFrame(function(c2d){
				c2d.fillStyle="red";
				c2d.arc(0,0,10,0,Math.PI*2);
				c2d.fill();
			});
			bdr.run(function(c2d){
				c2d.save();
				c2d.beginPath();
				c2d.shadowOffsetX = 3;
				c2d.shadowOffsetY = 3;
				c2d.shadowBlur = 5;
				c2d.shadowColor ='rgba(0,0,0,1)';
				c2d.lineWidth="5";
				c2d.strokeStyle="rgba(0,0,0)";
				c2d.fillStyle="rgba(255,255,234,0.3)";
				c2d.rect(bdr.x-bdr.width/2,bdr.y-bdr.height/2,bdr.width,bdr.height);
				c2d.fill();
				c2d.stroke();
				c2d.restore();

			});
			bdr.run(function(c2d){
				if(JF.stage.controller.up)
					bdr.y-=5;
				if(JF.stage.controller.down)
					bdr.y+=5;
				if(JF.stage.controller.left)
					bdr.x-=5;
				if(JF.stage.controller.right)
					bdr.x+=5;
			});
			var kenUp = new JF.DObject();
			kenUp.frameTime = 4;
			kenUp.x = 0;
			kenUp.y = -120;
			kenUp.width = 78;
			kenUp.height = 55;
			kenUp.rotate = Math.PI;
			kenUp.setTexture(TexureAtlasKenfs);
			bdr.add(kenUp);
			
			var kenright = new JF.DObject();
			kenright.frameTime = 6;
			kenright.x = 120;
			kenright.y = 0;
			kenright.width = 78;
			kenright.height = 55;
			kenright.rotate = Math.PI*1.5;
			kenright.setTexture(TexureAtlasKenfs);
			bdr.add(kenright);
			
			var kenBottom = new JF.DObject();
			kenBottom.frameTime = 3;
			kenBottom.x = 0;
			kenBottom.y = 120;
			kenBottom.width = 78;
			kenBottom.height = 55;
			kenBottom.setTexture(TexureAtlasKenfs);
			bdr.add(kenBottom);
			
			var kenLeft = new JF.DObject();
			kenLeft.frameTime = 4;
			kenLeft.x = -120;
			kenLeft.y = 0;
			kenLeft.width = 78;
			kenLeft.height = 55;
			kenLeft.rotate = Math.PI*0.5;
			kenLeft.setTexture(TexureAtlasKenfs);
			bdr.add(kenLeft);
			
			
			JF.stage.add(bdr);
			var bdr1 = new JF.DObject("bdr1",600,300,550,550)
			bdr1.setBGBorder(1,'green');
			bdr1.addFrame(function(c2d){
				c2d.fillStyle="green";
				c2d.arc(0,0,5,0,Math.PI*2);
				c2d.fill();
			});
			JF.stage.add(bdr1);
			
			var mouseLine = new JF.DObject();
			
			mouseLine.run(function(c2d){
				c2d.save();
				c2d.beginPath();
				c2d.lineWidth = 0.5;
				c2d.strokeStyle ='rgba(200,0,0,0.8)';
				c2d.moveTo(0,mouseLine.y);
				c2d.lineTo(JF.stage.width,mouseLine.y);
				c2d.moveTo(mouseLine.x,0);
				c2d.lineTo(mouseLine.x,JF.stage.height);
				c2d.stroke();
				c2d.closePath();
				c2d.restore();
			});
			mouseLine.x = 400;
			mouseLine.y =350;
			
			JF.stage.add(mouseLine);
			
			var rad = new JF.DObject('moserrad');
			rad.x = 0;rad.y = 0;
			rad.radius = 100;
			rad.canCollision = true;
			rad.setBGBorder(2,"rgba(234,236,43,0.9)","rgba(255,186,231,0.5)");
			rad.addFrame(function(c2d){
				c2d.fillStyle="rgba(0, 0, 0, 1)";
				c2d.arc(0,0,5,0,Math.PI*2);
				c2d.fill();	
			});
			JF.stage.add(rad);
			var posrad = new JF.DObject();
			posrad.radius  = 5;
			posrad.addFrame(function(c2d){
				c2d.translate(-58,-58);
				c2d.fillStyle="#ffffff";
				c2d.shadowBlur =	5;
				c2d.shadowColor	="rgba(0, 0, 0, 1)";
				c2d.shadowOffsetX =	0;
				c2d.shadowOffsetY	= 0;
				c2d.arc(0,0,5,0,Math.PI*2);
				c2d.fill();
			});
			
			posrad.run(function(){
				posrad.rotate += 0.1;
				if(posrad.rotate >= Math.PI*2)
					posrad.rotate =0;
			});
			rad.add(posrad);
			var rad1 = new JF.DObject('dad1');
			rad1.x = 500;rad1.y = 450;
			rad1.radius = 50;
			//rad1.canCollision = true;
			rad1.run(function(c2d){
				c2d.save();
				c2d.beginPath();
				c2d.lineWidth = 3;
				c2d.strokeStyle="rgba(255,255,255,1)";
				c2d.arc(rad1.x,rad1.y,rad1.radius,0,2*Math.PI);
				c2d.fillStyle="#195395";
				c2d.fill();
				c2d.stroke();
				c2d.closePath();
				c2d.restore();
			});
			
			
			JF.stage.add(rad1);
			
			var agge = new JF.DObject('agee1',500,200,200,200);
			agge.radius = 100;
			agge.frameTime = 20;
			agge.setBGBorder(1,'#E41212');
			agge.addFrame(function(c2d){
				c2d.fillStyle = 'rgba(102,60,60,0.8)';
				c2d.arc(0,0,10,10,0,2*Math.PI);
				c2d.fill();
			});
			agge.addFrame(function(c2d){
				c2d.fillStyle = 'rgba(131,140,31,0.8)';
				c2d.arc(0,0,20,20,0,2*Math.PI);
				c2d.fill();
			});
			agge.addFrame(function(c2d){
				c2d.fillStyle = 'rgba(61,97,215,0.8)';
				c2d.arc(0,0,30,30,0,2*Math.PI);
				c2d.fill();
			});
			agge.addFrame(function(c2d){
				c2d.fillStyle = 'rgba(61,100,215,0.8)';
				c2d.arc(0,0,20,20,0,2*Math.PI);
				c2d.fill();
			});
			agge.addFrame(function(c2d){
				c2d.fillStyle = 'rgba(64,215,61,0.8)';
				c2d.arc(0,0,10,10,0,2*Math.PI);
				c2d.fill();
			});
			JF.stage.addEvent(function(eventobj){

				if(eventobj.type =="collision.cf"){
					//console.log(eventobj.colls[0].id+"--"+eventobj.colls[1].id);
				}
			});
			JF.stage.add(agge);
			JF.stage.play();
			
			var s1 = new JF.Sound('rs/au/许嵩-断桥残雪.ogg');
			s1.play();
			
		});
	</script>
	<div style="height:300px"></div>
	<div style="position:fixed;top:0px;right:0px;">
		<button onclick="JF.stage.pause();">stop</button><button onclick="JF.stage.play();">start</button>
	</div>
</body>
</html>